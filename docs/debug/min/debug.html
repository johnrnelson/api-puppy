<!DOCTYPE html>
<html lang="en-US">

<!-- 
    This is the DEBUG UI. Use a browser to get more information and 
    the abilty to debug.
-->

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Loading API Tool</title>

    <link href="https://fonts.googleapis.com/css?family=Abel" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">



    <link rel="stylesheet" href="https://api-puppy.johnrnelson.com/metroui/css/metro-all.min.css">

    <link rel="stylesheet" href="https://api-puppy.johnrnelson.com/metroui/css/metro.min.css">
    <link rel="stylesheet" href="https://api-puppy.johnrnelson.com/metroui/css/metro-colors.min.css">
    <link rel="stylesheet" href="https://api-puppy.johnrnelson.com/metroui/css/metro-rtl.min.css">
    <link rel="stylesheet" href="https://api-puppy.johnrnelson.com/metroui/css/metro-icons.min.css">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

    <script src="https://api-puppy.johnrnelson.com/metroui/js/metro.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.3/ace.js"> </script> <!-- SERVER SIDE -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.3/ext-language_tools.js"> </script> <!-- SERVER SIDE -->


    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"> </script> <!-- SERVER SIDE -->

    <!-- Must be loaded last! -->
    <script>
        /*
    WebApp is the main namespace used so add your own
    modules to this one to prevent collision.
*/

const WebApp = {
    /*
        Quick and easy way to get data from our api...
        Ex: WebApp.Fetch
    */
    Fetch(data = {}) {
        const url = document.URL + '';

        //Allways add the APIKEY to outbound requests to the server...
        data.APIKEY = WebApp.AppPrefs.UserOptions.APIKEY;


        return fetch(url, {
            method: "PUT", // *GET, POST, PUT, DELETE, etc.
            mode: "cors", // no-cors, cors, *same-origin
            cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
            credentials: "omit", // include, *same-origin, omit

            headers: {
                "Content-Type": "application/json",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Headers": "*",
            },
            redirect: "follow", // manual, *follow, error
            referrer: "no-referrer", // no-referrer, *client
            body: JSON.stringify(data), // body data type must match "Content-Type" header
        }).then(response => response.json()); // parses JSON response into native Javascript objects 

    },
    GetHelpFile(FilePath, OnFetch) {
        // WebApp.GetHelpFile('',function(){});

        WebApp.Fetch({
            service: 'help',
            data: {
                topic: 'debug-code-fetch',
                filepath: FilePath
            }
        }).then(data => {
            if (data.err) {
                console.warn(data.err);
            } else {
                OnFetch(data);
            }


        }).catch(error => {
            console.warn('Error!');
            console.error(error);
            // debugger;
        });

    },

    //Your local app preferences...
    AppPrefs: {
        UserOptions: {
            APIKEY: '',
            UserID: '',
            TargetAPI: {
                url: document.URL,
                opts: {
                    favor: 'put'
                }
            }
        },
    }
};


if (localStorage) {
    const UserOptionsText = localStorage.getItem('UserOptions');

    if (UserOptionsText) {
        console.info('Reloading App options....');
        WebApp.AppPrefs.UserOptions = JSON.parse(UserOptionsText);
    } else {
        console.info('Storing (local) App options....');
        localStorage.setItem("UserOptions", JSON.stringify(WebApp.AppPrefs.UserOptions));
    }

} else {
    alert('No Local Storage!');
}



/*
    Help Display UI supporting javascript...
*/
WebApp.GetHelpFile('HelpDisplay.js', function (filecontents) {
    const srcScript = document.createElement("script");
    srcScript.innerHTML = filecontents.body;
    document.head.appendChild(srcScript);

    WebApp.GetHelpFile('HelpDisplay.css', function (filecontents) {
        const CSSFile = document.createElement("style");
        CSSFile.type = "text/css";
        CSSFile.innerHTML = filecontents.body;
        document.head.appendChild(CSSFile);
    });

});


/*
    Load our debugger ui supporting javascript...
*/
WebApp.GetHelpFile('DebuggerUI.js', function (filecontents) {
    const srcScript = document.createElement("script");
    srcScript.innerHTML = filecontents.body;
    document.head.appendChild(srcScript);


    WebApp.GetHelpFile('DebuggerUI.css', function (filecontents) {
        const CSSFile = document.createElement("style");
        CSSFile.type = "text/css";
        CSSFile.innerHTML = filecontents.body;
        document.head.appendChild(CSSFile);
    });

});



/*
    After page has loaded, you can be sure that everything you need
    is already loaded and ready to go...
*/
window.onload = function () {

    /* 
        Extra Helper code...
    */
    WebApp.GetHelpFile('UIHelper.js', function (UIHelperJSCode) {



        //Stuff history logger..... :-)
        WebApp.GetHelpFile('HistoryLogger.html', function (HistoryLoggerHTML) {

            document.getElementById("HistoryLogger").innerHTML = HistoryLoggerHTML.body;

            WebApp.GetHelpFile('HistoryLogger.css', function (HistoryLoggerCSS) {
                const CSSFile = document.createElement("style");
                CSSFile.type = "text/css";
                CSSFile.innerHTML = HistoryLoggerCSS.body;
                document.head.appendChild(CSSFile);
            });

            //Now show the sys info in the main display...
            /*
                History Logger UI supporting javascript...
            */
            WebApp.GetHelpFile('HistoryLogger.js', function (filecontents) {
                const srcScript = document.createElement("script");
                srcScript.innerHTML = filecontents.body;
                document.head.appendChild(srcScript);

                // debugger;
                window.eval(UIHelperJSCode.body);


                WebApp.HistoryLogger.Logger.Add({
                    TID: 0,
                    Type: 707,
                    DT: new Date(),
                    Topic: "UI Status",
                    Source: "Browser",
                    Body: "The browser UI should be loaded and ready to go!",
                });



                //Which screen do you want to show first? Are you debugging the debugger? lol
                UIHelper.ShowTab('TabMain');



                //If you local host you are most likely debugging.. :-)
                if (document.location.hostname == "localhost") {
                    // debugger;
                    // UIHelper.ShowTab('TabDebugger');
                    // UIHelper.ShowTab('HistoryLogger');
                    // UIHelper.ShowTab('GitHubLinks');
                    // UIHelper.ShowTab('TabAppPrefs');
                }









            });

        });

























    }); //end UIHelper....

};

    </script>
</head>

<body>

    <desktop>


        <sidemenu>
            <!-- https://metroui.org.ua/menu.html#_h_menu -->
            <ul class="t-menu open verticle compact">
                <li id="TabMain-BTN" data-role="hint" data-hint-position="right"
                    data-hint-text="Basic help about the user interface">
                    <a href="JavaScript:UIHelper.ShowTab('TabMain')"><span class="fas fa-home"></span></a>
                </li>

                <li id="TabDebugger-BTN" data-role="hint" data-hint-position="right"
                    data-hint-text="Interactive debugger to test with">
                    <a href="JavaScript:UIHelper.ShowTab('TabDebugger')"><span class="fas fa-bug"></span></a></li>



                <li id="HistoryLogger-BTN" data-role="hint" data-hint-position="right"
                    data-hint-text="Simple logger so you don't have to use the console"><a
                        href="JavaScript:UIHelper.ShowTab('HistoryLogger')"><span class="fas fa-file-code"></span></a>
                </li>


                <li id="TabAppPrefs-BTN" data-role="hint" data-hint-position="right"
                    data-hint-text="Web App Preferences"><a href="JavaScript:UIHelper.ShowTab('TabAppPrefs')">
                        <span class="fas fa-cogs"></span></a></li>



            </ul>

        </sidemenu>


        <!-- Log the history and help the user know whats up... -->
        <MainTabDisplay id="HistoryLogger"></MainTabDisplay>
 

        <!-- Because of the editor, you need to declare this first! -->
        <MainTabDisplay id="TabDebugger">
            <div class="DebugToolbar">

                <div class="dropdown-button" title="Select Verb">
                    <button id="DebugVerbList_BTN" class="button dropdown-toggle"></button>
                    <ul id="DebugVerbList_UL" class="d-menu" data-role="dropdown">
                    </ul>
                </div>
                <div class="dropdown-button" title="Select Example">
                    <button id="DebugSampleList_BTN" class="button dropdown-toggle"></button>
                    <ul id="DebugSampleList_UL" class="d-menu" data-role="dropdown">
                    </ul>
                </div>

                <div class="dropdown-button" title="Select the target language">
                    <button id="Export_BTN" class="button dropdown-toggle">Export</button>
                    <ul id="Export_UL" class="d-menu" data-role="dropdown">

                        <li><a href="#" title="Export sample code for CURL"
                                onclick="WebApp.DebugUI.ExportCode('curl')">curl</a>
                        </li>
                        <li><a href="#" title="Export sample code for JavaScript Browser"
                                onclick="WebApp.DebugUI.ExportCode('javascript-fetch')">JavaScript</a></li>
                        <li><a href="#" title="Export sample code for JavaScript HTTP Client"
                                onclick="WebApp.DebugUI.ExportCode('javascript-http-request')">NodeJS</a></li>
                        <li><a href="#" title="Export sample code for pythod 3"
                                onclick="WebApp.DebugUI.ExportCode('python 3')">Python 3</a></li>
                        <li><a class="disabled" href="#" title="Export sample code for C# .Net">C#</a></li>
                    </ul>
                </div>

            </div>



            <div class="split-container">

                <div data-role="splitter" class="h-100" data-split-sizes="60, 40" data-min-sizes="60,60"
                    data-gutter-size="8">

                    <div class="d-flex flex-justify-center flex-align-center">
                        <div class="split-header" title="The body of the request in JSON format">
                            &nbsp;<i class="fas fa-upload" style="color:silver"></i>
                            &nbsp;Upload JSON
                            <span id="Date_Uploaded"></span>
                            <span class="iconbuttons">
                                <a title="Use HTTP GET for the request" id="api-uri-link" href="#"
                                    target="_blank">GET</a>
                                <a title="Use HTTP PUT for the request"
                                    href="JavaScript:WebApp.DebugUI.MakeHTTP_PUT_Request();">PUT</a>
                                <a title="Use the socket for the request"
                                    href="JavaScript:WebApp.DebugUI.MakeSocketRequest();">SOCKET</a>
                            </span>
                        </div>
                        <div id="PayloadEditor" class="ace-editor"></div>
                    </div>
                    <div class="d-flex flex-justify-center flex-align-center">
                        <div class="split-header" title="The result of the request in JSON format">
                            &nbsp;<i class="fas fa-download" style="color:silver"></i>&nbsp;Download JSON
                            from Server <span id="Date_Downloaded"></span></div>
                        <div id="APIDebugResults" class="APIDebugResults"></div>
                    </div>
                </div>


            </div>


        </MainTabDisplay>


        <MainTabDisplay id="TabAppPrefs">
            <div style="padding:10px;">
                <h1>Web Application Preferences</h1>
                <p>
                    All values are stored locally in the browser, not the server. So if the
                    browser deletes it you will have to reinput the values.
                </p>
                <br>

                <div class="row">
                    <div class="cell-md-6">
                        <label>API Key</label>
                        <!-- <form > -->
                        <input id="APIKeyInput" type="password" autocomplete="off" placeholder="Enter your API Key">
                        <!-- </form> -->
                        <br>
                        <button class="button"
                            onclick="UIHelper.AppPrefs.TestKey(document.getElementById('APIKeyInput').value)">Test API
                            Key</button>
                    </div>
                    <div class="cell-md-6">
                        <label>Target Server</label>

                        <select data-role="select">
                            <optgroup label="Local Network">
                                <option value="localhost" selected="selected">localhost</option>
                                <option value="0.0.0.0">0.0.0.0</option>
                            </optgroup>
                            <optgroup label="Remote Servers">
                                <option value="demo.tektology.com">demo.tektology.com</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <hr />

                <div class="row">
                    <div class="cell-md-10">
                        <p>
                            Use this to clear the browser local storage.
                        </p>
                        <p>
                            Remember that user settings are kept there so you
                            will have to put your preferences back in.
                        </p>
                    </div>
                    <div class="cell-md-2">
                        <button class="button" onclick="UIHelper.AppPrefs.ClearPrefs()">Clear Local Storage</button>
                    </div>
                </div>
                <br>

                <hr />
                <br>
                <!-- <div class="row">

                <div class="cell-md-8">
                    Corrrect
                </div>
                <div class="cell-md-2">
                    <input type="checkbox" data-role="switch" data-caption="Local Storage" checked>
                    <br>
                    <input type="checkbox" data-role="switch" data-caption="Log Changes" checked>
                </div>
            </div> -->

            </div>

        </MainTabDisplay>
        <MainTabDisplay id="TabMain" style="overflow:auto;"></MainTabDisplay>

    </desktop>

    <!-- 
        Simple way to let the user know the screen is too small
        Check the debug.css for the media query styles...
     -->
    <smallscreen>
        <center>

            <div>
                THE SCREEN IS TOO SMALL
                TO USE THIS DEMO!
            </div>
        </center>
    </smallscreen>
</body>

</html>