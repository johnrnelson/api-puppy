<!DOCTYPE html>
<!-- 
    This is the DEBUG UI. Use a browser to get more information and 
    the abilty to debug.
-->



<html>

<head>


    <title>api-puppy Demo Site</title>

    <link href='//fonts.googleapis.com/css?family=Abel' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Roboto+Condensed:300' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">



    <link rel="stylesheet" href="//cdn.metroui.org.ua/v4/css/metro-all.min.css">

    <link rel="stylesheet" href="//cdn.metroui.org.ua/v4/css/metro.min.css">
    <link rel="stylesheet" href="//cdn.metroui.org.ua/v4/css/metro-colors.min.css">
    <link rel="stylesheet" href="//cdn.metroui.org.ua/v4/css/metro-rtl.min.css">
    <link rel="stylesheet" href="//cdn.metroui.org.ua/v4/css/metro-icons.min.css">

    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="//cdn.metroui.org.ua/v4/js/metro.min.js"></script>


    <script src="//cdnjs.cloudflare.com/ajax/libs/ace/1.2.3/ace.js"> </script> <!-- SERVER SIDE -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/ace/1.2.3/ext-language_tools.js"> </script> <!-- SERVER SIDE -->


    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"> </script> <!-- SERVER SIDE -->



    <script>
//SERVER-SIDE-REPLACE!!!
    </script>


    <script>
        /*
    Simple wrapper to test the API using the browser.

    Adding in whatever you can to help the user actually use the API!
*/

const DebugUI = {
    //Quick and easy way to get data from our api...
    Fetch(data = {}) {
        const url = document.URL + '';

        return fetch(url, {
            method: "PUT", // *GET, POST, PUT, DELETE, etc.
            mode: "cors", // no-cors, cors, *same-origin
            cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
            credentials: "omit", // include, *same-origin, omit

            headers: {
                "Content-Type": "application/json",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Headers": "*",
            },
            redirect: "follow", // manual, *follow, error
            referrer: "no-referrer", // no-referrer, *client
            body: JSON.stringify(data), // body data type must match "Content-Type" header
        }).then(response => response.json()); // parses JSON response into native Javascript objects 

    },


    /*
        The rest is just setting up the UI for the user...
    */
    //Show the server info via HTML in a componet fashion....
    SetSysInfo() {
        //You will find this on the `debug.html` page...
        const SystemInfo = document.getElementById("SystemInfo");

        //Setup a simple function to add html to our DOM... super simple!!!!!!!!!
        function AddInfoElement(InfoText, InfoTip, ElementData) {
            const NewEL = document.createElement('div');
            NewEL.innerHTML = '<b>' + InfoText + '</b> : ' + ElementData;
            NewEL.title = InfoTip;
            NewEL.className = "FooterSysInfo";
            SystemInfo.appendChild(NewEL);
        }


        //The user info for the client to use...
        // console.log(debugdata.UserInfo);

        if (debugdata.UserInfo.isAuthenticated) {
            AddInfoElement('Security Level', 'Level of permissions on the server', debugdata.UserInfo.SecurityLevel);
        } else {
            AddInfoElement('Security Status', 'Your current user status from the servers perspective.', 'Not Authenticated');
        }


        AddInfoElement('Access Point', 'The protocal, port, hostname, path, and query string for the current request using for the API',
            '<b>' + window.location.protocol + '</b>//' + window.location.hostname +
            '<b>' + debugdata.UserInfo.URL + '</b>');

        AddInfoElement('Node Version', 'The version of node on this server',
            debugdata.NodeVersion);

        AddInfoElement('Server Version', 'The version of the APIServer.js file.',
            debugdata.ServerVersion);

        AddInfoElement('Start Date', 'The date the server started', debugdata.ST.toLocaleDateString() + " " + debugdata.ST.toLocaleTimeString());


    },

    //Fill the side bar with options we can use in our debugger...
    FillSideBar() {

        const dbSidebar = document.getElementById('debugger-sidbar');
        const DebugVerbList = dbSidebar.querySelector("#DebugVerbList");
        const ExampleCodeList = dbSidebar.querySelector("#ExampleCodeList");

        //When the user selects something different...
        DebugVerbList.onchange = function () {

            const SelOpt = this.selectedOptions[0];

            //Quick clear the old stuff...
            ExampleCodeList.innerHTML = "";
            // debugger;



            DebugUI.Fetch({
                service: 'help',
                data: {
                    topic: 'sample-code-list',
                    sampleid: SelOpt.value

                }
            }).then(data => {
                // console.log('Set default examples---...', data);

                for (let index = 0; index < data.samples.length; index++) {
                    const sample = data.samples[index];
                    const opt = document.createElement('option');
                    opt.value = sample;
                    opt.innerHTML = sample;
                    ExampleCodeList.appendChild(opt);
                }

                ExampleCodeList.onchange();

            }) // JSON-string from `response.json()` call
                .catch(error => {
                    console.warn('Error!');
                    console.warn(data);
                    console.error(error);
                    // debugger;
                });


        };


        //When the user selects something different...
        ExampleCodeList.onchange = function () {

            const SelVerb = DebugVerbList.selectedOptions[0];

            const SelOpt = this.selectedOptions[0];

            DebugUI.Fetch({
                service: 'help',
                data: {
                    topic: 'sample-code-fetch',
                    sampleid: SelOpt.innerHTML,
                    'target-service': SelVerb.innerHTML
                }
            }).then(data => {

                if (data.err) {
                    debugger;
                    console.warn(data.err);
                } else {

                    UIHelper.Ace.AceEditor.setValue(JSON.stringify(data.code, null, "\t"));

                    //Set the cursor so the user can start over again...
                    UIHelper.Ace.AceEditor.moveCursorTo(0);


                    UIHelper.Ace.AceDisplayRsults.setValue("{}");

                    //Set the cursor so the user can start over again...
                    UIHelper.Ace.AceDisplayRsults.moveCursorTo(0);
                }


            }) // JSON-string from `response.json()` call
                .catch(error => {
                    console.error(error);
                    debugger;
                });


        };


        for (var n in debugdata.apidata) {
            //We don't add the default here!
            // if (n != "default") {
            // }
            const namespaceData = debugdata.apidata[n];

            const optEl = document.createElement('option');
            optEl.RecordData = namespaceData;
            optEl.value = n;
            optEl.innerHTML = n;
            DebugVerbList.appendChild(optEl);

        }

        //Use the default and set the edtor....
        DebugVerbList.onchange();

    },
    OpenDialog(DialogInfo) {
        // debugger;


        console.info('ok kill it')
        Metro.dialog.create({
            title: DialogInfo.title,
            content: DialogInfo.body,
            closeButton: true
        });

    },
    //Use the HTTP to request the data...
    MakeHTTPRequest() {

        // debugger;
        //Get our contents from the editor...
        const JSONPayload = DebugUI.GetEditorJSON();




        if (JSONPayload) {
            DebugUI.Fetch(JSONPayload)
                .then(data => {

                    const resultJSONText = JSON.stringify(data, null, "\t");
                    DebugUI.ShowJSONResult('HTTP', resultJSONText);

                    UIHelper.Logger.Add({
                        TID: 0,
                        Type: 200,
                        DT: new Date(),
                        Topic: "HTTP Request",
                        Source: "Browser",
                        Body: "Result length : " + resultJSONText.length,
                    });

                }) // JSON-string from `response.json()` call
                .catch(error => {
                    console.warn('Error in running the debug!');
                    console.error(error);
                    // debugger;
                });
        }


    },
    //Use the socket to request the data...
    MakeSocketRequest() {

        const displayDateUP = document.getElementById('Date_Downloaded');
        displayDateUP.innerHTML = "@" + new Date().toLocaleTimeString();

        //Get our contents from the editor...
        const JSONPayload = DebugUI.GetEditorJSON();
        // console.info(JSONPayload);
        DebugUI.WebSocketConnection.send(JSON.stringify(JSONPayload));


    },
    /*
        Toggle the result panel if we are too lazy to check out the 
        window console. lol  :-)
    */
    ToggleResult(ShowFlag) {

        debugger;

        const APIDebugResultsElement = document.getElementById("APIDebugResults");
        const AceEditorElement = document.getElementById("PayloadEditor");

        //Toggle if no falg defined!
        if (!ShowFlag) {
            if (APIDebugResultsElement.style.display == "none") {
                ShowFlag = true;
            } else {
                ShowFlag = false;
            }
        }

        debugger;
        if (ShowFlag) {
            APIDebugResultsElement.style.display = "";
            // AceEditorElement.style.bottom = "200px";
        } else {
            APIDebugResultsElement.style.display = "none";
            // AceEditorElement.style.bottom = "0";
        }

        //Make sure the Ace editor knows it's been resized...
        UIHelper.Ace.AceEditor.resize();
    },


    GetEditorJSON() {

        try {
            return JSONPayload = JSON.parse(UIHelper.Ace.AceEditor.getValue());


        } catch (errorJSON) {

            const modalWindow = document.querySelector('#mastermodal');
            const modalWindowTitle = modalWindow.querySelector('.modal-title');
            const modalWindowBody = modalWindow.querySelector('.modal-body');

            modalWindowTitle.innerHTML = "Error in JSON!";

            modalWindowBody.innerHTML = `
            <div>Fix the JSON errors before attempting to call the API!</div> 
            <br> 
            `;

            $('#mastermodal').modal({
                show: true
            });
            return null;
        }

    },
    //Pop a window to show the code!
    ExportCode(TypeOfCode) {


        //Get our contents from the editor...
        const JSONPayload = DebugUI.GetEditorJSON();

        /*
            Define the languages supported and how to help...
        */
        const languages_supported = {
            'curl': function () {

                return {
                    title: 'Command line "curl"',
                    code: `curl --request GET --data '${JSON.stringify(JSONPayload)}' ${window.location.href}`,
                    help: 'Check out the man page for curl for more information.',
                }
            },
            'javascript-fetch': function () {

                return {
                    title: 'Browser javascript',
                    code: `
                var url = '${document.URL}'; 
            
                fetch(url, {
                    method: "PUT", // *GET, POST, PUT, DELETE, etc.
                    mode: "cors", // no-cors, cors, *same-origin
                    cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
                    credentials: "omit", // include, *same-origin, omit
                    headers: {
                        "Content-Type": "application/json",
                        "Access-Control-Allow-Origin": "*",
                        "Access-Control-Allow-Headers": "*",                        
                    },
                    redirect: "follow", // manual, *follow, error
                    referrer: "no-referrer", // no-referrer, *client
                    body: JSON.stringify(${JSON.stringify(JSONPayload)}), // body data type must match "Content-Type" header
                }).then(response => response.json()).then(JSON => {
                    console.info('This is the result of the request!');
                    console.log(JSON);
                    debugger;
                }); // parses JSON response into native Javascript objects 
                 
                
                `,
                    help: 'You can use xhr but I guess fetch is the new thing.',
                }
            },
            'javascript-http-request': function () {
                return {
                    title: 'NodeJS HTTP Request',
                    code: `** SAMPLE CODE for npm "request" **`,
                    help: 'There are many ways to use request objects in Node.',
                }
            },
            'python 3': function () {
                return {
                    title: 'Python 3 Broken Example :-)',
                    code: `

import json
import requests

api_token = 'your_api_token'
api_url_base = '${document.URL}'
headers = {'Content-Type': 'application/json','Authorization': 'Bearer {0}'.format(api_token)}
api_url = '{0}account'.format(api_url_base)
response = requests.get(api_url, headers=headers)
response_data = response.json() 
print(response_data)  

                `,
                    help: 'No Python experts helping us out with this?',
                }
            }
        };



        const active_lang = languages_supported[TypeOfCode]({
            jSON: 'data'
        });

        //User wants to use something we don't know about???
        if (!active_lang) {
            console.warn('somebody update something? Did you check git for the latest code? TypeOfCode"' + TypeOfCode + '" not found!');
        } else {

            DebugUI.OpenDialog({
                title: active_lang.title,
                body: `
                <div>Please help us improve this!</div>
                <pre><code>${active_lang.code.replace(/\n/g, '<br>')}</code></pre>
                <br>
                <b><i>${active_lang.help}</i></b>
                `
            });


        }//End if right type of code...
    },
    /*
        Show our TargetURI for the client to call.
    */
    SetTargetURI(TargetURI) {
        const apiURIAddress = document.getElementById('api-uri-address');
        const apiURILink = document.getElementById('api-uri-link');


        // const displayDateDOWN = document.getElementById('Date_Uploaded');
        // displayDateDOWN.innerHTML = "@" + new Date().toLocaleTimeString();


        apiURIAddress.value = TargetURI;
        apiURILink.href = TargetURI;



    },
    ShowJSONResult(JSONSource, JSONText) {
        const displayDateMod = document.getElementById('Date_Downloaded');
        displayDateMod.innerHTML = ' from [' + JSONSource + '] &nbsp;@' + new Date().toLocaleTimeString();

        UIHelper.Ace.AceDisplayRsults.setValue(JSONText);

        //Set the cursor so the user can start over again...
        UIHelper.Ace.AceDisplayRsults.moveCursorTo(0);

        UIHelper.Ace.AceDisplayRsults.resize();

        UIHelper.Logger.Add({
            TID: 0,
            Type: 707,
            DT: new Date(),
            Topic: "Server Response",
            Source: "Browser",
            Body: "JSON Length:" + JSONText.length + " ",
        });

    }
};


const UIHelper = {
    QueryStringBuilder(JSONData) {

        //Simple function to serialize the json into array for query string...
        function DigestQS(Prefix, QSObject, QSArray) {

            // debugger;

            for (var o in QSObject) {
                if (typeof (QSObject[o]) == "object") {
                    if (Prefix) {
                        DigestQS(Prefix + o, QSObject[o], QSArray);
                    } else {
                        DigestQS(o + ".", QSObject[o], QSArray);
                    }

                } else {
                    if (QSObject[o] != "") {
                        if (Prefix) {
                            QSArray.push(Prefix + o + "=" + QSObject[o]);
                        } else {
                            QSArray.push(o + "=" + QSObject[o]);

                        }

                    }

                }


            }
        }

        try {
            if (typeof (JSONData) == "string") {
                if (JSONData.length == 0) {
                    DebugUI.SetTargetURI("**EMPTY**");
                    return;
                }
                JSONData = JSON.parse(JSONData);;
            }


            if (JSONData.service) {

                var selectedService = JSONData.service;
                delete JSONData["service"];

                const basicOptions = [];


                DigestQS("", JSONData, basicOptions);


                // if (basicOptions.length) {
                // }
                DebugUI.SetTargetURI('/' + selectedService + '?' + basicOptions.join('&'));

            } else {
                DebugUI.SetTargetURI("**ERROR**");

            }

        } catch (errBadJSON) {
            console.warn('Error In JSON!', errBadJSON);
            DebugUI.SetTargetURI("** bad json **");
        }

    },
    Ace: {
        AceEditor: null, //Set this in code when you are ready...
        AceDisplayRsults: null, //Set this in code when you are ready...        
        SetCompleters(Editor2Complete) {


            var langTools = ace.require("ace/ext/language_tools");

            Editor2Complete.Completer = {
                getCompletions: (editor, session, caretPosition2d, prefix, callback) => {

                    var currline = editor.getSelectionRange().start.row;
                    var content = editor.session.getLine(currline);


                    const WordList = [];
                    WordList.push({
                        caption: 'service',
                        meta: '',
                        score: 10,
                    });

                    WordList.push({
                        caption: 'FunStuff',
                        meta: '',
                        score: 10,
                    });
                    WordList.push({
                        caption: 'demo',
                        meta: '',
                        score: 30,
                    });


                    callback(null, WordList.map((s) => {
                        return {
                            // name: s.caption,
                            value: s.caption,
                            score: 100,
                            meta: s.meta,
                        }
                    }))
                },
            }
            langTools.addCompleter(Editor2Complete.Completer);
        },
        HookEvents(Editor2Hook) {
            console.info('Hooking Events for the editor...');

            Editor2Hook.getSession().on('change', function (delta) {

                const editorJSON = Editor2Hook.getValue();
                UIHelper.QueryStringBuilder(editorJSON);


            });
        },
        SetupAceEditorDefaults(ParentHTMLTagID) {

            //Ace Editor is awesome! 
            var aceEditor = ace.edit(ParentHTMLTagID);

            // Go here for more options... https://github.com/ajaxorg/ace/wiki/Configuring-Ace
            aceEditor.setOption("mode", "ace/mode/json");
            aceEditor.setOption("autoScrollEditorIntoView", true);
            aceEditor.setOption("showPrintMargin", false);
            aceEditor.setOption("fontSize", 15);
            aceEditor.$blockScrolling = Infinity;

            return aceEditor;
        },

        BuildAceControls() {


            UIHelper.Ace.AceEditor = UIHelper.Ace.SetupAceEditorDefaults('PayloadEditor');
            UIHelper.Ace.AceDisplayRsults = UIHelper.Ace.SetupAceEditorDefaults('APIDebugResults');

            //Make sure display is read only!
            UIHelper.Ace.AceDisplayRsults.setReadOnly(true);

            UIHelper.Ace.AceDisplayRsults.setTheme("ace/theme/monokai");

            //Only hook the actual editor!!!!!
            UIHelper.Ace.HookEvents(UIHelper.Ace.AceEditor);



            //Add your own stuff to the drop downs...
            UIHelper.Ace.SetCompleters(UIHelper.Ace.AceEditor);


            UIHelper.Ace.AceEditor.setOptions({
                enableBasicAutocompletion: UIHelper.Ace.AceEditor.Completer,
                enableLiveAutocompletion: true,
                enableSnippets: true,
            });


        }
    },

    //Simple show tab...
    ShowTab(Tab2Show) {
        var TabElement;
        var BTNElement;
  
        if (typeof (Tab2Show) == "string") {
            TabElement = document.getElementById(Tab2Show);
            BTNElement = document.getElementById(Tab2Show+"-BTN");
        }else{
            console.warn('ShowTab Error!','"Tab2Show" must be a string!');
            debugger;
        }

        if (!UIHelper.ActiveTab) {
            UIHelper.ActiveTab = TabElement;
            UIHelper.ActiveTabButton = BTNElement;
            // UIHelper.ActiveTabButton.style.backgroundColor = "blue";
            // UIHelper.ActiveTabButton.addCl('selected')
            UIHelper.ActiveTabButton.classList.add("selected-maintab");
        } else {
            UIHelper.ActiveTab.style.display = "none";
            UIHelper.ActiveTab.style.display = "none";
            UIHelper.ActiveTab = TabElement;
            // UIHelper.ActiveTabButton.style.backgroundColor = "transparent";
            UIHelper.ActiveTabButton.classList.remove("selected-maintab");



            UIHelper.ActiveTabButton = BTNElement;
            // UIHelper.ActiveTabButton.style.backgroundColor = "blue";
            UIHelper.ActiveTabButton.classList.add("selected-maintab");
        }

        UIHelper.ActiveTab.style.display = "block";
         
    },
    MasterSocket: {
        Connnect() {
            //



            // WEBSOCKET
            var SocketURL;
            if (document.location.protocol == "https:") {
                SocketURL = 'wss://' + document.location.hostname + ":" + document.location.port;
            } else {
                SocketURL = 'ws://' + document.location.hostname + ":" + document.location.port;
            }
            DebugUI.WebSocketConnection = new WebSocket(SocketURL)

            DebugUI.WebSocketConnection.onerror = error => {
                console.log(`WebSocket error: ${error}`)
            };
            DebugUI.WebSocketConnection.onmessage = e => {
                const jsonData = JSON.parse(e.data);

                UIHelper.Logger.Add({
                    Type: 466,
                    TID: 505,
                    DT: new Date(),
                    Topic: "Socket Traffic!",
                    Source: "Socket",
                    Body: "Socket data length:" + e.data.length + "",
                });

                //Do not display service messages!
                if (jsonData.TID == 0) {
                    // console.log('Web Socket:', jsonData);
                    // // debugger;

                    return;
                }

                DebugUI.ShowJSONResult('HTTP', JSON.stringify(jsonData, null, "\t"));

            };
            DebugUI.WebSocketConnection.onopen = () => {

                //An example...
                /*
                DebugUI.WebSocketConnection.send(JSON.stringify({
                    service: "time"
                }));
                */
                UIHelper.Logger.Add({
                    Type: 411,
                    TID: 0,
                    DT: new Date(),
                    Topic: "Socket Connected!",
                    Source: "Browser",
                    Body: "Woot",
                });
            };






        }
    },
    Logger: {
        Clear() {

            Metro.dialog.create({
                title: "Clear the history?",
                content: "<div>Are you sure you want to do this?</div>",
                actions: [
                    {
                        caption: "Agree",
                        cls: "js-dialog-close alert",
                        onclick: function () {
                            const tblBody = document.getElementById('HistoryLoggerTable');
                            tblBody.innerHTML = "";
                        }
                    },
                    {
                        caption: "Disagree",
                        cls: "js-dialog-close",
                        onclick: function () {
                            console.info("History was not deleted!");
                        }
                    }
                ]
            });


        },
        Add(LogMSG) {


            try {
                if (!LogMSG.Type) {
                    LogMSG.Type = 0;
                }

                function CellBuider(HostRow, ID, Title, ClassName, HTMLValue) {
                    const newCell = document.createElement('td');
                    newCell.title = Title;
                    newCell.className = ClassName;
                    newCell.innerHTML = HTMLValue;
                    newCell.vAlign = "top";
                    newCell.align = "left";

                    HostRow.appendChild(newCell)
                    // return newCell
                }

                if (!LogMSG.DT) {
                    LogMSG.DT = new Date()
                }

                const displayDT = moment(LogMSG.DT);
                var dispLogType;
                if (LogMSG.Type < 0) {
                    dispLogType = '<i class="fas fa-globe fa-lg"></i>';
                }
                if (LogMSG.Type == 0) {
                    dispLogType = '<i class="fas fa-disk fa-lg"></i>';
                }
                if (LogMSG.Type > 0) {
                    dispLogType = '<i class="fas fa-file fa-lg"></i>';
                }

                if (LogMSG.Type == 200) {
                    dispLogType = '<i class="fas fa-globe-americas fa-lg"></i>';
                }

                if (LogMSG.Type == 411) {
                    dispLogType = '<i class="fas fa-info-circle fa-lg"></i>';
                }

                if (LogMSG.Type == 466) {
                    dispLogType = '<i class="fas fa-share-alt fa-lg"></i>';
                }

                if (LogMSG.Type == 707) {
                    dispLogType = '<i class="far fa-eye fa-lg"></i>';
                }



                const tblBody = document.getElementById('HistoryLoggerTable');

                const tr = document.createElement('tr');

                // debugger;

                CellBuider(tr, "", "TID Help", "", LogMSG.TID);
                CellBuider(tr, "", "Type Of Log Item [" + LogMSG.Type + "]", "", dispLogType);
                CellBuider(tr, "", displayDT.format("dddd, MMMM Do YYYY, h:mm:ss a"), "", displayDT.format("h:mm:ss a"));
                CellBuider(tr, "", "", "", LogMSG.Topic);
                CellBuider(tr, "", "", "", LogMSG.Source);
                CellBuider(tr, "", "", "", LogMSG.Body);

                tblBody.appendChild(tr);
            } catch (errAddLogItem) {
                alert('Error adding to the log!!!\r\n' + errAddLogItem.message);
            }


        }
    }

};



/*
    After page has loaded, you can be sure that everything you need
    is already loaded and ready to go...
*/
window.onload = function () {





    //Setup our UI parts...
    DebugUI.SetSysInfo();
    DebugUI.FillSideBar();


    //Setup all of our ace editors...
    UIHelper.Ace.BuildAceControls();


    console.info('The API Client has loaded. Feel free to explore this object in the console.');

    /*
        This is only available to the debug client. We 
        don't put this in normal requests from users... 
    */
    console.info(`
    
        Use : "ServerAPI" for easy code to help with testing.
        Use : "debugdata" in the console for the api data help.
    
    `);


    //Connect to our websocket server....
    UIHelper.MasterSocket.Connnect();

    //Which screen do you want to show first? Are you debugging the debugger? lol
    UIHelper.ShowTab('TabMain');
    // debugger;
    // UIHelper.ShowTab('TabDebugger');
    // UIHelper.ShowTab('HistoryLogger');
    // UIHelper.ShowTab('GitHubLinks');

    UIHelper.Logger.Add({
        TID: 0,
        Type: 707,
        DT: new Date(),
        Topic: "UI Status",
        Source: "Browser",
        Body: "The browser UI should be loaded and ready to go!",
    });


};

    </script>

    <style>
        /* 

    This is your chance to color up the debug UI!!! 

    Don't blame John for the ugly CSS. He's slow and color blind. :-) 

*/

body {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    overflow: hidden;

}







sidemenu {
    background-color: rgb(70, 70, 70);
    color: blue;

    display: block;
    overflow: hidden;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    /* right: 0 */
    width: 40px;
    border: solid 1px silver;
}

sidemenu .t-menu {
    background-color: transparent;
}

sidemenu li {
    color: white !important;
    text-shadow: 1px 1px 1px #6e6e6e;
}

sidemenu li:hover {
    color: rgb(200, 192, 235) !important;
}

sidemenu .selected-maintab {
    color: white;
    background-color: black;
    margin: 0;
    padding: 0;
}

 



TopNav {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0
}

MainTabDisplay {
    display: none;
    overflow: hidden;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 40px;
    right: 0;
}

MainTabDisplay#GitHubLinks {
    margin: 15px;
    padding: 10px;
    overflow: auto;
}

MainTabDisplay .container {
    margin: 10px;
    padding: 10px;
    /*     
    margin-left: 10px;
    padding-left: 10px;
    margin-right: 0;
    padding-right: 0; */
}



MainTabDisplay HistoryLoggerTable {
    position: absolute;

    top: 40px;
    bottom: 0;
    left: 0;
    right: 0;

    display: block;
    margin: 0;
    padding: 10px;
    background-color: transparent !important;
    color: black;
    /* height: 100%;
    width: 100%; */
    overflow: auto !important;
}



MainTabDisplay .h-menu {
    background-color: rgb(0, 0, 54);
}

MainTabDisplay .h-menu a {
    color: white;
}

MainTabDisplay .h-menu li:hover {
    color: gold;
}


/* 

    Other stuff.....

*/




/* The debugger section */


.ace-editor {
    border: solid 1px silver;
    position: absolute;
    top: 30px;
    bottom: 0;
    left: 0;
    right: 0;
    overflow: auto;
    /* height: 100%; */
    /* width: 100%;     */
}

.APIDebugResults {
    border: solid 1px silver;
    /* position: relative;
    height: 100%;
    width: 100%; */
    position: absolute;
    top: 30px;
    bottom: 0;
    left: 0;
    right: 0;
    overflow: auto;
}
































#TabDebugger .api-uri-display {
    position: absolute;
    top: 0;
    height: 30px;
    right: 0;
    left: 30px;
    background-color: rgb(236, 236, 236);
    color: white;
    /* padding-right:1px; */
    /* margin:4px; */
}

#TabDebugger .api-uri-display #api-uri-address {
    position: relative;
    width: 100%;
    height: 100%;
    border: 0;
    padding: 3px;

    background-color: transparent;
    font-family: 'Roboto', sans-serif;
    color: purple;
    font-weight: bold;
    text-overflow: ellipsis;
    font-size: 18px;

}



#TabDebugger .api-uri-browse {
    position: absolute;

    top: 0;
    height: 30px;
    left: 0;
    /* right: 0; */
    width: 30px;
    background-color: transparent;
    color: blue;
    padding: 1px;
    /* margin:4px; */
    font-size: 20px;
    text-align: center
}

#TabDebugger .api-uri-browse:hover {
    color: black;
}






/* 
sidebar 
*/
#TabDebugger #debugger-sidbar {
    position: absolute;
    top: 35px;
    bottom: 0;
    left: 0;
    width: 150px;
    background-color: rgb(54, 54, 54);
    color: white;
    padding: 5px;
    font-family: 'Abel', sans-serif;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

#debugger-sidbar select {
    background-color: transparent;
    width: 100%;
    color: gold;
}

#debugger-sidbar .ActionButton {
    font-family: 'Roboto', sans-serif;
    font-size: 16px;

    font-variant: small-caps;


    border-radius: 6px;

    color: rgb(82, 82, 82);

    left: 0;
    right: 0;

    text-align: center;
    text-decoration: none;

    /* background-color: rgb(212, 212, 212); */
    cursor: pointer;
    margin-top: 10px;
    text-shadow: 1px 1px 1px #ffffff;
    background: -webkit-radial-gradient(center, ellipse cover, #F5F5F5 0%, rgb(194, 194, 194) 100%);
}

#debugger-sidbar .ActionButton:hover {
    color: blue;

}



/* Main help text classes...  */

.HelpText {
    color: rgb(94, 94, 94);
    font-size: 16px;
    font-family: 'PT Sans', sans-serif;
}

pre {
    margin: 5px;
    padding: 25px;
    background-color: rgb(238, 238, 238);
    height: 80%;
    overflow: auto;
}

pre code {
    white-space: nowrap !important;
}

.buttonclick {
    cursor: pointer;
    color: green;
}

.todo-item {
    color: green;
    font-size: 12px;
}

/* 
FOOTER STYLES!!!!!! 
*/

.footer-row {
    padding-top: 50px;
    margin-bottom: 100px;
    font-family: 'Abel', sans-serif;
    font-size: 16px;

}

.FooterHeading {
    color: green;
    font-size: 18px;
    font-weight: bold;
}


.FooterSysInfo {
    color: gray;
    cursor: default;
}

.FooterSysInfo:hover {
    color: silver !important;
    cursor: hand;
}



















/* 
split info from https://gist.github.com/jpnelson/52d6f38820c6d028bdf8

slightly modified.... 
*/


.split-container {
    position: absolute;
    left: 150px;
    right: 0;
    top: 35px;
    bottom: 0;
    border: 0;
    background-color: transparent;
}

.split-header {
    position: absolute;
    top: 0;
    height: 30px;
    left: 0;
    right: 0;
    /* width: 100%; */
    background-color: rgb(0, 70, 70);
    color: white;
    cursor: help;
    border: solid 1px silver;
    padding: 2px;

    text-shadow: 1px 1px 1px #202020;
    font-family: 'Roboto Condensed', sans-serif;
    font-size: 16px;
    font-weight: bold;
    /* font-variant: small-caps; */
}
    </style>
</head>

<body>
    <sidemenu>
        <!-- https://metroui.org.ua/menu.html#_h_menu -->
        <ul class="t-menu open verticle compact">
            <li id="TabMain-BTN" title="Basic help about the user interface"><a
                    href="JavaScript:UIHelper.ShowTab('TabMain')"><span class="fas fa-home"></span></a></li>
            <li id="TabDebugger-BTN" title="Interactive debugger to test with"><a
                    href="JavaScript:UIHelper.ShowTab('TabDebugger')"><span class="fas fa-bug"></span></a></li>
            <li id="HistoryLogger-BTN" title="Simple logger so you don't have to use the console"><a
                    href="JavaScript:UIHelper.ShowTab('HistoryLogger')"><span class="fas fa-file-code"></span></a></li>

            <li id="GitHubLinks-BTN" title="GitHub project for the source code"><a href="JavaScript:UIHelper.ShowTab('GitHubLinks')">
                    <span class="fab fa-github"></span></a></li>
        </ul>

    </sidemenu>

    <MainTabDisplay id="GitHubLinks">
        <!-- footer -->
        <h2>GitHub Project Links</h2>

        <p>
            Use the links below to get to the source code of the stuff needed to use this project.
        </p>
        <br>
        <div class="HelpText">


            <div>
                <a href="https://github.com/johnrnelson/api-puppy" target="_blank">api-puppy Project</a>
                <br>
                Actual source code for this project.
            </div>
            <div>
                <a href="https://github.com/ajaxorg/ace" target="_blank">Ace Editor</a>
                <br>
                The HTML editor used for UI. It's good stuff, you should check it out.
            </div>
            <div>
                <a href="https://github.com/olton/Metro-UI-CSS" target="_blank">Metro-UI-CSS</a>
                <br>
                A step up from bootstrap. Nice and easy HTML and CSS to display what we need.
            </div>
            <div>
                <a href="https://github.com/moment/moment" target="_blank">Moment.js</a>
                <br>
                Parse, validate, manipulate, and display dates and times in JavaScript.
            </div>


        </div>


    </MainTabDisplay>
    <!-- Log the history and help the user know whats up... -->
    <MainTabDisplay id="HistoryLogger">


        <ul class="h-menu">
            <li title="Clear the log history"><a href="JavaScript:UIHelper.Logger.Clear()">Clear</a></li>
            <li title="Export to a file"><a href="#">Export</a></li>
        </ul>


        <HistoryLoggerTable>
            <table class="table  striped compact" style="background: transparent;">
                <thead xxclass="sortable-column">
                    <tr>
                        <th width="30px" vertical-align="top">#</th>
                        <th width="50px" vertical-align="top">Type</th>
                        <th width="120px" vertical-align="top" nowrap="true">Date/Time</th>
                        <th width="200px" vertical-align="top" nowrap="true">Topic</th>
                        <th width="200px" vertical-align="top" nowrap="true">Source</th>
                        <th widht="80%" vertical-align="top">Body</th>
                    </tr>
                </thead>
                <tbody id="HistoryLoggerTable" class="row-hover">
                </tbody>
            </table>
        </HistoryLoggerTable>


    </MainTabDisplay>






    <!-- Because of the editor, you need to declare this first! -->
    <MainTabDisplay id="TabDebugger">
        <span class="api-uri-browse" title="Open a new tab to test the URL">
            <a id="api-uri-link" href="/testme/woof" target="_blank"> <i class="fas fa-globe"></i> </a>
        </span>
        <span class="api-uri-display" title="URI Endpoint address">
            <input id="api-uri-address" value="" onchange="document.getElementById('api-uri-link').href=this.value;" />
        </span>


        <div id="debugger-sidbar">
            <center>


                <select id="DebugVerbList" title="List of basic services provided by this server"></select>
                <br>
                <select id="ExampleCodeList" title="Sample code to test with."></select>
                <br>

                <div title="Use HTTP for the request" onclick="DebugUI.MakeHTTPRequest()" class="ActionButton">HTTP
                    Request</div>


                <div title="Use the socket for the request" onclick="DebugUI.MakeSocketRequest()" class="ActionButton">
                    Socket Request</div>


                <div style="padding-top:15px;">Export Options</div>

                <div title="Export sample code for CURL" onclick="DebugUI.ExportCode('curl')" class="ActionButton">CURL
                </div>

                <div title="Export sample code for JavaScript Browser" onclick="DebugUI.ExportCode('javascript-fetch')"
                    class="ActionButton">
                    JavaScript</div>

                <div title="Export sample code for JavaScript HTTP Client"
                    onclick="DebugUI.ExportCode('javascript-http-request')" class="ActionButton">NodeJS</div>

                <div title="Export sample code for pythod 3" onclick="DebugUI.ExportCode('python 3')"
                    class="ActionButton">Python3</div>

                <hr width="90%" size="1" color="gold" />



            </center>
        </div>







        <div class="split-container">



            <div data-role="splitter" class="h-100" data-split-sizes="60, 40" data-min-sizes="60,60"
                data-gutter-size="8">

                <div class="d-flex flex-justify-center flex-align-center">
                    <div class="split-header" title="The body of the request in JSON format">




                        &nbsp;<i class="fas fa-upload" style="color:silver"></i>
                        &nbsp;Upload JSON Request
                        <!-- <select id="DebugVerbList" title="List of basic services provided by this server"></select>
                        <select id="ExampleCodeList" title="Sample code to test with."></select> -->

                        <span id="Date_Uploaded"></span>
                    </div>
                    <div id="PayloadEditor" class="ace-editor"></div>
                </div>
                <div class="d-flex flex-justify-center flex-align-center">
                    <div class="split-header" title="The result of the request in JSON format">
                        &nbsp;<i class="fas fa-download" style="color:silver"></i>&nbsp;Download JSON
                        from Server <span id="Date_Downloaded"></span></div>
                    <div id="APIDebugResults" class="APIDebugResults"></div>
                </div>
            </div>


        </div>


    </MainTabDisplay>


    <MainTabDisplay id="TabMain" style="overflow:auto;">
        <!-- HelpDisplay -->


<div class="container">






    <div class="page-header">
        <h1>api-puppy Demo</h1>
    </div>



    <div class="HelpText">
        <div>
            This is not another framework or library or
            even a template, it's just a demo!
        </div>
        <p>
            This is actually the API. Seriously!

        </p>

        <p>
            You are going to find bugs because this is just a DEMO! Lots of work
            needs to be done and things may or may not get worked on. Use Google
            Chrome and you will get less errors in the DEBU UI.
        </p>
        <p>
            Check out the
            <a target="_blank" href="https://github.com/johnrnelson/api-puppy">GitHub Project</a> to
            see the source code to see how you can use it in your own projects.
        </p>

        <p>
            Use the <a href="JavaScript:UIHelper.ShowTab('TabDebugger')">Debug Tool</a> for testing
            the API to make sure you get what you want before having to test it in your own code.
        </p>

        <p>
            The only way to see the web socket data is using the console.
            Not enough time is being spent on the UI.
        </p>
    </div>



    <!-- footer -->
    <div class="row footer-row">
        <div id="SystemInfo" class="cell">
            <div class="FooterHeading">System Information</div>
        </div>
        <div class="cell">
            <div class="FooterHeading">Open Source Components</div>

            <a title="Used to make the simple UI" target="_blank" href="https://github.com/olton/Metro-UI-CSS">Metro 4</a>
            <br>
            <a title="Code editor for the API Explorer" target="_blank" href="https://ace.c9.io/">Ace Editor</a>
            <br>
            <a title="Wikipedia article about jQuery" target="_blank"
                href="https://en.wikipedia.org/wiki/JQuery">jQuery</a>
            <br>
            <a title="Wikipedia article about Node.js" target="_blank"
                href="https://en.wikipedia.org/wiki/Node.js">Node.js</a>
            <br>
        </div>
    </div>
</div>
    </MainTabDisplay>
</body>

</html>